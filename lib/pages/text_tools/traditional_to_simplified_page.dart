import 'package:flutter/material.dart';
import 'package:pinyin/pinyin.dart';
import '../../components/base_tool_page.dart';
import '../../components/input_output_card.dart';
import '../../components/custom_button.dart';
import '../../components/colors.dart';

class TraditionalToSimplifiedPage extends StatefulWidget {
  const TraditionalToSimplifiedPage({super.key});

  @override
  // ignore: library_private_types_in_public_api
  _TraditionalToSimplifiedPageState createState() => _TraditionalToSimplifiedPageState();
}

class _TraditionalToSimplifiedPageState extends State<TraditionalToSimplifiedPage> {
  final TextEditingController _inputController = TextEditingController();
  final TextEditingController _outputController = TextEditingController();

  // 繁体到简体的映射表（常用字部分）
  final Map<String, String> _traditionalToSimplified = {
    '愛': '爱', '礙': '碍', '襖': '袄', '罷': '罢', '擺': '摆', '辦': '办', '絆': '绊', '幫': '帮',
    '寶': '宝', '報': '报', '幣': '币', '斃': '毙', '標': '标', '錶': '表', '彆': '别', '變': '变',
    '濱': '滨', '補': '补', '纔': '才', '參': '参', '慘': '惨', '燦': '灿', '層': '层', '產': '产',
    '饞': '馋', '纏': '缠', '懺': '忏', '償': '偿', '廠': '厂', '徹': '彻', '塵': '尘', '陳': '陈',
    '襯': '衬', '撐': '撑', '稱': '称', '懲': '惩', '遲': '迟', '衝': '冲', '蟲': '虫', '醜': '丑',
    '齣': '出', '礎': '础', '儲': '储', '觸': '触', '處': '处', '傳': '传', '瘡': '疮', '闖': '闯',
    '創': '创', '詞': '词', '辭': '辞', '聰': '聪', '叢': '丛', '竄': '窜', '錯': '错', '達': '达',
    '帶': '带', '貸': '贷', '擔': '担', '膽': '胆', '導': '导', '燈': '灯', '鄧': '邓', '敵': '敌',
    '糴': '籴', '遞': '递', '點': '点', '澱': '淀', '電': '电', '鼕': '冬', '鬥': '斗', '獨': '独',
    '噸': '吨', '奪': '夺', '墮': '堕', '兒': '儿', '爾': '尔', '發': '发', '罰': '罚', '閥': '阀',
    '琺': '珐', '礬': '矾', '範': '范', '販': '贩', '飯': '饭', '訪': '访', '紡': '纺', '飛': '飞',
    '廢': '废', '奮': '奋', '糞': '粪', '鳳': '凤', '膚': '肤', '婦': '妇', '復': '复', '蓋': '盖',
    '乾': '干', '趕': '赶', '個': '个', '鞏': '巩', '溝': '沟', '構': '构', '購': '购', '夠': '够',
    '蠱': '蛊', '顧': '顾', '颳': '刮', '關': '关', '觀': '观', '櫃': '柜', '廣': '广', '歸': '归',
    '龜': '龟', '國': '国', '過': '过', '漢': '汉', '號': '号', '閤': '合', '轟': '轰', '紅': '红',
    '後': '后', '鬍': '胡', '壺': '壶', '護': '护', '滬': '沪', '戶': '户', '譁': '哗', '華': '华',
    '畫': '画', '懷': '怀', '壞': '坏', '歡': '欢', '環': '环', '還': '还', '迴': '回', '會': '会',
    '匯': '汇', '誨': '诲', '繪': '绘', '葷': '荤', '渾': '浑', '夥': '伙', '獲': '获', '擊': '击',
    '雞': '鸡', '積': '积', '極': '极', '際': '际', '繼': '继', '紀': '纪', '夾': '夹', '傢': '家',
    '價': '价', '艱': '艰', '監': '监', '堅': '坚', '繭': '茧', '儉': '俭', '撿': '捡', '簡': '简',
    '減': '减', '薦': '荐', '艦': '舰', '劍': '剑', '漿': '浆', '獎': '奖', '講': '讲', '膠': '胶',
    '澆': '浇', '驕': '骄', '攪': '搅', '絞': '绞', '矯': '矫', '僥': '侥', '腳': '脚', '覺': '觉',
    '階': '阶', '節': '节', '潔': '洁', '結': '结', '捷': '捷', '竭': '竭', '誡': '诫',
    '錦': '锦', '僅': '仅', '進': '进', '盡': '尽', '勁': '劲', '舊': '旧', '劇': '剧', '據': '据',
    '懼': '惧', '捲': '卷', '絹': '绢', '決': '决', '訣': '诀', '絕': '绝', '鈞': '钧',
    '軍': '军', '開': '开', '凱': '凯', '墾': '垦', '懇': '恳', '摳': '抠', '庫': '库', '褲': '裤',
    '誇': '夸', '塊': '块', '儈': '侩', '寬': '宽', '礦': '矿', '虧': '亏', '窺': '窥', '饋': '馈',
    '睏': '困', '臘': '腊', '蠟': '蜡', '蘭': '兰', '攔': '拦', '欄': '栏', '爛': '烂', '濫': '滥',
    '撈': '捞', '勞': '劳', '樂': '乐', '壘': '垒', '類': '类', '纍': '累', '裏': '里', '禮': '礼',
    '麗': '丽', '歷': '历', '勵': '励', '礫': '砾', '隸': '隶', '倆': '俩', '聯': '联', '憐': '怜',
    '煉': '炼', '練': '练', '糧': '粮', '療': '疗', '遼': '辽', '瞭': '了', '獵': '猎', '鄰': '邻',
    '臨': '临', '鈴': '铃', '靈': '灵', '齡': '龄', '嶺': '岭', '劉': '刘', '瀏': '浏', '流': '流',
    '樓': '楼', '爐': '炉', '陸': '陆', '錄': '录', '賂': '赂', '亂': '乱', '侖': '仑', '羅': '罗',
    '蘿': '萝', '邏': '逻', '鑼': '锣', '籮': '箩', '駱': '骆', '媽': '妈', '馬': '马', '罵': '骂',
    '嗎': '吗', '買': '买', '麥': '麦', '賣': '卖', '邁': '迈', '脈': '脉', '蠻': '蛮', '饅': '馒',
    '謾': '谩', '貓': '猫', '錨': '锚', '鉚': '铆', '貿': '贸', '麼': '么', '黴': '霉', '每': '每',
    '們': '们', '悶': '闷', '夢': '梦', '瞇': '眯', '覓': '觅', '祕': '秘', '冪': '幂', '綿': '绵',
    '緬': '缅', '廟': '庙', '滅': '灭', '蔑': '蔑', '畝': '亩', '惱': '恼', '腦': '脑', '鬧': '闹',
    '餒': '馁', '內': '内', '嫩': '嫩', '能': '能', '擬': '拟', '釀': '酿', '鳥': '鸟', '聶': '聂',
    '齧': '啮', '鑷': '镊', '鎳': '镍', '檸': '柠', '寧': '宁', '擰': '拧', '濘': '泞', '紐': '纽',
    '鈕': '钮', '農': '农', '膿': '脓', '濃': '浓', '弄': '弄', '瘧': '疟', '諾': '诺', '哦': '哦',
    '歐': '欧', '毆': '殴', '嘔': '呕', '漚': '沤', '盤': '盘', '龐': '庞', '刨': '刨', '賠': '赔',
    '噴': '喷', '鵬': '鹏', '碰': '碰', '騙': '骗', '票': '票', '貧': '贫', '蘋': '苹', '憑': '凭',
    '評': '评', '潑': '泼', '撲': '扑', '鋪': '铺', '棲': '栖', '齊': '齐', '騎': '骑', '棋': '棋',
    '啟': '启', '氣': '气', '棄': '弃', '汽': '汽', '纖': '纤', '簽': '签', '牽': '牵', '鉗': '钳',
    '前': '前', '錢': '钱', '潛': '潜', '淺': '浅', '譴': '谴', '槍': '枪', '嗆': '呛', '牆': '墙',
    '薔': '蔷', '強': '强', '搶': '抢', '鍬': '锹', '橋': '桥', '喬': '乔', '僑': '侨', '翹': '翘',
    '竅': '窍', '竊': '窃', '寢': '寝', '慶': '庆', '瓊': '琼', '秋': '秋', '麯': '曲', '權': '权',
    '勸': '劝', '確': '确', '卻': '却', '鵲': '鹊', '讓': '让', '擾': '扰', '熱': '热', '認': '认',
    '紉': '纫', '榮': '荣', '絨': '绒', '軟': '软', '銳': '锐', '閏': '闰', '潤': '润', '灑': '洒',
    '薩': '萨', '傘': '伞', '喪': '丧', '騷': '骚', '掃': '扫', '澀': '涩', '殺': '杀', '紗': '纱',
    '篩': '筛', '曬': '晒', '刪': '删', '衫': '衫', '姍': '姗', '陝': '陕', '閃': '闪', '傷': '伤',
    '賞': '赏', '燒': '烧', '紹': '绍', '賒': '赊', '攝': '摄', '紳': '绅', '審': '审', '嬸': '婶',
    '腎': '肾', '滲': '渗', '聲': '声', '勝': '胜', '聖': '圣', '師': '师', '獅': '狮', '濕': '湿',
    '詩': '诗', '屍': '尸', '時': '时', '蝕': '蚀', '實': '实', '適': '适', '勢': '势', '視': '视',
    '試': '试', '壽': '寿', '獸': '兽', '書': '书', '術': '术', '樹': '树', '帥': '帅', '雙': '双',
    '誰': '谁', '稅': '税', '順': '顺', '說': '说', '碩': '硕', '爍': '烁', '絲': '丝', '飼': '饲',
    '聳': '耸', '慫': '怂', '頌': '颂', '訟': '讼', '誦': '诵', '蘇': '苏', '訴': '诉', '肅': '肃',
    '雖': '虽', '隨': '随', '綏': '绥', '歲': '岁', '孫': '孙', '損': '损', '筍': '笋', '縮': '缩',
    '鎖': '锁', '牠': '它', '塌': '塌', '攤': '摊', '壇': '坛', '歎': '叹', '湯': '汤', '燙': '烫',
    '濤': '涛', '絛': '绦', '討': '讨', '騰': '腾', '謄': '誊', '體': '体', '屜': '屉', '條': '条',
    '貼': '贴', '鐵': '铁', '廳': '厅', '聽': '听', '烴': '烃', '停': '停', '頭': '头', '圖': '图',
    '塗': '涂', '團': '团', '橢': '椭', '窪': '洼', '襪': '袜', '彎': '弯', '灣': '湾', '頑': '顽',
    '萬': '万', '網': '网', '韋': '韦', '違': '违', '圍': '围', '為': '为', '偽': '伪', '葦': '苇',
    '偉': '伟', '緯': '纬', '衛': '卫', '穩': '稳', '問': '问', '烏': '乌', '汙': '污', '誣': '诬',
    '無': '无', '吳': '吴', '蕪': '芜', '塢': '坞', '霧': '雾', '務': '务', '誤': '误', '係': '系',
    '戲': '戏', '細': '细', '蝦': '虾', '轄': '辖', '峽': '峡', '俠': '侠', '狹': '狭', '鹹': '咸',
    '顯': '显', '險': '险', '現': '现', '縣': '县', '線': '线', '獻': '献', '鄉': '乡', '廂': '厢',
    '鑲': '镶', '詳': '详', '樣': '样', '陽': '阳', '養': '养', '癢': '痒', '鑰': '钥',
    '藥': '药', '爺': '爷', '葉': '叶', '頁': '页', '醫': '医', '儀': '仪', '億': '亿', '憶': '忆',
    '義': '义', '藝': '艺', '異': '异', '譯': '译', '繹': '绎', '詣': '诣', '議': '议', '誼': '谊',
    '陰': '阴', '蔭': '荫', '銀': '银', '飲': '饮', '隱': '隐', '應': '应', '英': '英',
    '營': '营', '蠅': '蝇', '穎': '颖', '喲': '哟', '擁': '拥', '傭': '佣', '踴': '踊', '詠': '咏',
    '湧': '涌', '憂': '忧', '優': '优', '郵': '邮', '鈾': '铀', '猶': '犹', '遊': '游', '誘': '诱',
    '與': '与', '嶼': '屿', '譽': '誉', '遷': '迁', '餘': '余', '魚': '鱼', '漁': '渔', '娛': '娱',
    '語': '语', '育': '育', '獄': '狱', '欲': '欲', '諭': '谕', '喻': '喻', '禦': '御', '裕': '裕',
    '愈': '愈', '籲': '吁', '遇': '遇', '預': '预', '豫': '豫', '園': '园', '員': '员', '圓': '圆',
    '緣': '缘', '遠': '远', '願': '愿', '約': '约', '躍': '跃', '嶽': '岳', '運': '运',
    '醞': '酝', '暈': '晕', '韻': '韵', '雜': '杂', '災': '灾', '齋': '斋', '在': '在', '再': '再',
    '贊': '赞', '贓': '赃', '髒': '脏', '鑿': '凿', '棗': '枣', '竈': '灶', '皂': '皂', '責': '责',
    '擇': '择', '澤': '泽', '賊': '贼', '贈': '赠', '紮': '扎', '劄': '札', '軋': '轧', '閘': '闸',
    '鍘': '铡', '詐': '诈', '債': '债', '沾': '沾', '氈': '毡', '戰': '战', '棧': '栈',
    '綻': '绽', '張': '张', '漲': '涨', '帳': '帐', '脹': '胀', '賬': '账', '趙': '赵', '摺': '折',
    '這': '这', '貞': '贞', '針': '针', '偵': '侦', '診': '诊', '陣': '阵', '鎮': '镇', '掙': '挣',
    '睜': '睁', '徵': '征', '猙': '狰', '爭': '争', '幀': '帧', '鄭': '郑', '證': '证', '織': '织',
    '職': '职', '執': '执', '侄': '侄', '擲': '掷', '質': '质', '摯': '挚', '滯': '滞', '致': '致',
    '鐘': '钟', '腫': '肿', '種': '种', '眾': '众', '晝': '昼', '驟': '骤', '豬': '猪', '諸': '诸',
    '誅': '诛', '燭': '烛', '煮': '煮', '矚': '瞩', '囑': '嘱', '貯': '贮', '鑄': '铸', '築': '筑',
    '住': '住', '注': '注', '祝': '祝', '駐': '驻', '專': '专', '磚': '砖', '轉': '转', '賺': '赚',
    '撰': '撰', '篆': '篆', '樁': '桩', '莊': '庄', '壯': '壮', '狀': '状', '準': '准', '濁': '浊',
    '總': '总', '縱': '纵', '鄒': '邹', '詛': '诅', '組': '组', '鑽': '钻', '罪': '罪', '尊': '尊',
    '昨': '昨', '作': '作', '坐': '坐', '座': '座',
  };

  // 将繁体中文转换为简体中文
  void _convertToSimplified() {
    final String input = _inputController.text.trim();
    if (input.isEmpty) {
      _outputController.clear();
      return;
    }

    String result = '';
   result = ChineseHelper.convertToSimplifiedChinese(input);

    setState(() {
      _outputController.text = result;
    });
  }

  void _clearAll() {
    _inputController.clear();
    _outputController.clear();
  }

  void _copyToClipboard() {
    if (_outputController.text.isNotEmpty) {
      ScaffoldMessenger.of(context).showSnackBar(
        const SnackBar(content: Text('已复制到剪贴板')),
      );
    }
  }

  @override
  void dispose() {
    _inputController.dispose();
    _outputController.dispose();
    super.dispose();
  }

  @override
  Widget build(BuildContext context) {
    return BaseToolPage(
      title: '繁体转中文',
      child: SingleChildScrollView(
        // 统一页面内边距为12
        padding: const EdgeInsets.all(12.0),
        child: Column(
          crossAxisAlignment: CrossAxisAlignment.stretch,
          children: [
            InputOutputCard(
              inputController: _inputController,
              outputController: _outputController,
              inputLabel: '输入繁体中文',
              outputLabel: '简体中文结果',
              onClear: _clearAll,
              onCopy: _copyToClipboard,
            ),
            // 减少组件间距
            const SizedBox(height: 10),
            CustomButton.primary(
              text: '转换',
              onPressed: _convertToSimplified,
              width: double.infinity,
            ),
            // 减少组件间距
            const SizedBox(height: 10),
            Container(
              decoration: BoxDecoration(
                color: AppColors.background,
                borderRadius: BorderRadius.circular(8),
                border: Border.all(color: AppColors.border),
              ),
              padding: const EdgeInsets.all(12),
              child: Text(
                '此工具可将繁体中文文本转换为简体中文文本。适用于需要在不同语言标准间转换文本的场景，如阅读繁体文档、处理来自港澳台地区的文件等。',
                style: TextStyle(fontSize: 14, color: Colors.grey[700]),
              ),
            ),
          ],
        ),
      ),
    );
  }
}